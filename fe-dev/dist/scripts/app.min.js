/**
 * talkdesk-challenge
 * @Web 
 * @Author  - 
 * Updated on: 20190913-114209
 */
let app={debug:!0,debugLocalIps:["localhost","192.168.6.141"],mobileWidth:"768",loadedFonts:0,loadedImages:0,lang:document.querySelector("body").getAttribute("[data-lang]"),host:window.location.hostname,browser:!1,navigator:"",SIZE:{wW:window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,wH:window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight},DATA:{},COOKIES_NAMES:{ACCEPT:"acceptCookie"},exists:e=>$(e).length>0,isMobile:()=>app.SIZE.wW<=app.mobileWidth,debugEnvir:()=>app.debug&&void 0!==app.host&&app.debugLocalIps.length>0&&app.debugLocalIps.indexOf(app.host)>-1,init:()=>{$doc=document.documentElement,$body=$doc.querySelector("body");window.onresize=()=>{app.SIZE.wW=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,app.SIZE.wH=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,console.log("app window.onresize")},$doc.querySelector("#search__form")&&app.search.init()}};(()=>{"use strict";document.addEventListener("DOMContentLoaded",()=>{console.warn("ATENÇÃO: Debug está ligado!"),console.log("-- DOCUMENT IS READY - GO GO --"),app.init()})})(),app.helpers={TIMERS:"",DATA:"",AJAX:"",init:()=>{let e=app.helpers;e.setupEvents(),e.setupLayout()},setupEvents:()=>{},setupLayout:()=>{},browserDetect:()=>{let e=window.navigator.userAgent,t=e.indexOf("MSIE ");if(t>0)return parseInt(e.substring(t+5,e.indexOf(".",t)),10);if(e.indexOf("Trident/")>0){let t=e.indexOf("rv:");return parseInt(e.substring(t+3,e.indexOf(".",t)),10)}let n=e.indexOf("Edge/");return n>0&&parseInt(e.substring(n+5,e.indexOf(".",n)),10)},osDetect:()=>{let e=!1;return-1!==navigator.appVersion.indexOf("Win")?e="Windows":-1!==navigator.appVersion.indexOf("Mac")?e="MacOS":-1!==navigator.appVersion.indexOf("X11")?e="UNIX":-1!==navigator.appVersion.indexOf("Linux")&&(e="Linux"),e},getUrlParam:(e,t)=>{t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");let n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null},getRandom:(e,t,n)=>"int"===n?(e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e):Math.random()*(t-e)+e,getClosest:(e,t)=>{for(Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),n=t.length;--n>=0&&t.item(n)!==this;);return n>-1});e&&e!==document;e=e.parentNode)if(e.matches(t))return e;return null},serializeArray:e=>{for(var t=[],n=0;n<e.elements.length;n++){var a=e.elements[n];if(a.name&&!a.disabled&&"file"!==a.type&&"reset"!==a.type&&"submit"!==a.type&&"button"!==a.type)if("select-multiple"===a.type)for(var i=0;i<a.options.length;i++)a.options[i].selected&&t.push({name:a.name,value:a.options[i].value});else("checkbox"!==a.type&&"radio"!==a.type||a.checked)&&t.push({name:a.name,value:a.value})}return t}},app.search={TIMERS:"",DATA:"",API_SEARCH:"https://talkdesk.com/wp-json/external/globalsearch",PAGE_SIZE:10,PAGES_TO_SKIPE:0,TOTAL_PAGES:0,TOTAL_ITEMS:0,CURRENT_PAGE:1,CURRENT_DATA:"",KEYWORD:"",init:()=>{console.log("=====\napp Search Init\n");let e=app.search;e.getSearch(t=>{e.setupEvents(),e.setupLayout()})},setupEvents:()=>{console.log("=====\napp Search === Events\n");let e=app.helpers,t=app.search;t.filtersHandler(),t.paginationHandler(),document.querySelector("form").addEventListener("change",n=>{let a=n.currentTarget,i=e.serializeArray(a);t.KEYWORD=i[0].value})},setupLayout:()=>{console.log("=====\napp Search === layout\n");let e=app.search;e.renderCards(),e.renderPagination(),document.getElementById("total-results").textContent=e.CURRENT_DATA.length},getSearch:e=>{console.log("=====\napp Search === first paint\n");let t=app.search,n=e;fetch(t.API_SEARCH).then(e=>{if(e.ok)return e.json();throw new Error("Something went wrong")}).then(e=>{t.DATA=e,"function"==typeof n&&n()}).catch(e=>{console.log(e),t.DATA=data})},filtersHandler:()=>{document.addEventListener("click",e=>{let t=e.target,n=t.parentNode,a=app.search;if(t.hasAttribute("data-filter")&&(e.preventDefault(),n.matches(".search__item")&&!n.matches(".search__item--active"))){console.log("=====\nFilter Handler"),console.log('active filter = "',t.getAttribute("data-filter"),'"'),document.getElementById("search-results--cards").innerHTML="",document.getElementById("pagination").innerHTML="";const e=document.querySelector(".search__item--active");e&&e.classList.remove("search__item--active"),n.className="search__item search__item--active",a.renderCards(),a.renderPagination(),document.getElementById("total-results").textContent=a.TOTAL_ITEMS||a.CURRENT_DATA.length,console.log('total pages = "',a.TOTAL_PAGES,'"'),console.log('total items = "',a.TOTAL_ITEMS||a.CURRENT_DATA.length,'"\n======')}},!1)},paginationHandler:()=>{document.addEventListener("click",e=>{let t=app.search,n=e.target;if(n.hasAttribute("data-page")){e.preventDefault();let a=document.querySelector(".search__item--active").children[0].getAttribute("data-filter");if(n.matches(".pagination__item")&&!n.matches(".pagination__item--active")||n.hasAttribute("data-page")&&n.matches(".button")){if(e.preventDefault(),t.DATA&&t.DATA.posts||t.CURRENT_DATA){console.log("==== !!!!!!!! ====\n",t.CURRENT_PAGE===n.getAttribute("data-page"),"\n==== !!!!!!!! ===="),"next"!==n.getAttribute("data-page")&&"prev"!==n.getAttribute("data-page")?t.CURRENT_PAGE=parseInt(n.getAttribute("data-page"),10):"next"===n.getAttribute("data-page")?(console.log("next"),t.CURRENT_PAGE=t.CURRENT_PAGE+1):"prev"===n.getAttribute("data-page")&&(console.log("prev"),t.CURRENT_PAGE=t.CURRENT_PAGE-1),document.getElementById("search-results--cards").innerHTML="",document.getElementById("pagination").innerHTML="",t.PAGES_TO_SKIPE=t.PAGE_SIZE*t.CURRENT_PAGE;const e=(e,t)=>{let n=e.title?e.title:"";return`\n                <a href="${e.url?e.url:"#"}" class="" target="_self" title="${n}">\n                  <span class="card__label text-orange">${e.category?e.category:""}</span>\n                  <span class="card__label text-capitalize">${e.date&&null!==e.date?e.date:""}</span>\n                  <h4 class="card__title">${n}</h4>\n                  <p class="card__url">${e.url?e.url.replace(/^.*:\/\//i,""):""}</p>\n                </a>`};let i=t.CURRENT_DATA;"*"===a?(t.TOTAL_PAGES=((t.DATA.posts.length-t.PAGE_SIZE)/t.PAGE_SIZE).toFixed(),t.TOTAL_ITEMS=t.DATA.posts.length,i.slice(t.PAGES_TO_SKIPE,-(t.DATA.posts.length-t.PAGE_SIZE-t.PAGES_TO_SKIPE)).map((t,n)=>{let a=e(t,n),i=document.createElement("div");i.className="col-12 card",i.innerHTML=a,document.getElementById("search-results--cards").append(i)})):(t.TOTAL_PAGES=0,t.TOTAL_ITEMS=0,i.filter(e=>(e.category===a&&(t.TOTAL_ITEMS++,t.TOTAL_PAGES=t.TOTAL_ITEMS-t.PAGE_SIZE>0?((t.TOTAL_ITEMS-t.PAGE_SIZE)/t.PAGE_SIZE).toFixed():0),e.category===a)).slice(t.PAGES_TO_SKIPE,-(t.TOTAL_ITEMS-t.PAGE_SIZE-t.PAGES_TO_SKIPE)).map((t,n)=>{let a=e(t,n),i=document.createElement("div");i.className="col-12 card",i.innerHTML=a,document.getElementById("search-results--cards").append(i)}));let o,r="";t.TOTAL_PAGES>1?(document.querySelector(".pagination").classList="pagination",t.CURRENT_PAGE>3&&(r="1",(o=document.createElement("li")).className="pagination__item bananas",o.setAttribute("data-page",1),o.innerHTML=r,document.getElementById("pagination").appendChild(o)),t.CURRENT_PAGE>3&&(r="...",(o=document.createElement("li")).className="pagination__item bananas",o.innerHTML=r,document.getElementById("pagination").appendChild(o)),t.CURRENT_PAGE>1?document.querySelector('.button[data-page="prev"').classList="button button--prev":document.querySelector('.button[data-page="prev"').classList="button button--prev invisible",t.CURRENT_PAGE-2>0&&(r=`${t.CURRENT_PAGE-2}`,(o=document.createElement("li")).className="pagination__item",o.setAttribute("data-page",t.CURRENT_PAGE-2),o.innerHTML=r,document.getElementById("pagination").appendChild(o)),t.CURRENT_PAGE-1>0&&(r=`${t.CURRENT_PAGE-1}`,(o=document.createElement("li")).className="pagination__item",o.setAttribute("data-page",t.CURRENT_PAGE-1),o.innerHTML=r,document.getElementById("pagination").appendChild(o)),r=`${t.CURRENT_PAGE}`,(o=document.createElement("li")).className="pagination__item pagination__item--active",o.setAttribute("data-page",t.CURRENT_PAGE),o.innerHTML=r,document.getElementById("pagination").appendChild(o),t.CURRENT_PAGE+1<=t.TOTAL_PAGES&&(r=`${t.CURRENT_PAGE+1}`,(o=document.createElement("li")).className="pagination__item",o.setAttribute("data-page",t.CURRENT_PAGE+1),o.innerHTML=r,document.getElementById("pagination").appendChild(o)),t.CURRENT_PAGE+2<t.TOTAL_PAGES&&(r=`${t.CURRENT_PAGE+2}`,(o=document.createElement("li")).className="pagination__item",o.setAttribute("data-page",t.CURRENT_PAGE+2),o.innerHTML=r,document.getElementById("pagination").appendChild(o)),t.CURRENT_PAGE+3<t.TOTAL_PAGES&&(r="...",(o=document.createElement("li")).className="pagination__item",o.innerHTML=r,document.getElementById("pagination").appendChild(o)),t.CURRENT_PAGE+3<t.TOTAL_PAGES&&(r=`${t.TOTAL_PAGES}`,(o=document.createElement("li")).className="pagination__item",o.setAttribute("data-page",t.TOTAL_PAGES),o.innerHTML=r,document.getElementById("pagination").appendChild(o)),t.CURRENT_PAGE<t.TOTAL_PAGES?document.querySelector('.button[data-page="next"').classList="button button--next":document.querySelector('.button[data-page="next"').classList="button button--next invisible"):document.querySelector(".pagination").classList="pagination hidden"}document.getElementById("total-results").textContent=t.TOTAL_ITEMS,console.log("=====\nPagination Handler"),console.log('active page = "',t.CURRENT_PAGE,'"'),console.log('filter used = "',a,'"'),console.log('total pages = "',t.TOTAL_PAGES,'"'),console.log('total items = "',t.TOTAL_ITEMS,'"\n======')}}},!1)},searchHandler:e=>{console.log("=====\nSearch Keyword"),e.preventDefault();let t=app.helpers,n=app.search,a=document.getElementById("search__form"),i=t.serializeArray(a);n.KEYWORD=i[0].value,n.renderCards(),n.renderPagination(),console.log('pages to skipe = "',n.PAGES_TO_SKIPE,'"'),console.log('total pages = "',n.TOTAL_PAGES,'"'),console.log('total items = "',n.TOTAL_ITEMS,'"'),console.log('active page = "',document.querySelector(".pagination__item--active")?document.querySelector(".pagination__item--active").getAttribute("data-page"):"N/A",'"\n======'),document.getElementById("keyword").textContent=n.KEYWORD,document.getElementById("total-results").textContent=n.TOTAL_ITEMS},renderPagination:()=>{let e=app.search;document.getElementById("pagination").innerHTML="",e.TOTAL_PAGES>1?(document.querySelector(".pagination").classList="pagination",e.CURRENT_PAGE>1?document.querySelector('.button[data-page="prev"]').classList="button button--prev":document.querySelector('.button[data-page="prev"]').classList="button button--prev invisible",e.CURRENT_PAGE>3&&(markup="1",container=document.createElement("li"),container.className="pagination__item bananas",container.setAttribute("data-page",1),container.innerHTML=markup,document.getElementById("pagination").appendChild(container)),e.CURRENT_PAGE>3&&(markup="...",container=document.createElement("li"),container.className="pagination__item bananas",container.innerHTML=markup,document.getElementById("pagination").appendChild(container)),e.CURRENT_PAGE-2>0&&(markup=`${e.CURRENT_PAGE-2}`,container=document.createElement("li"),container.className="pagination__item",container.setAttribute("data-page",e.CURRENT_PAGE-2),container.innerHTML=markup,document.getElementById("pagination").appendChild(container)),e.CURRENT_PAGE-1>0&&(markup=`${e.CURRENT_PAGE-1}`,container=document.createElement("li"),container.className="pagination__item",container.setAttribute("data-page",e.CURRENT_PAGE-1),container.innerHTML=markup,document.getElementById("pagination").appendChild(container)),markup=`${e.CURRENT_PAGE}`,container=document.createElement("li"),container.className="pagination__item pagination__item--active",container.setAttribute("data-page",e.CURRENT_PAGE),container.innerHTML=markup,document.getElementById("pagination").appendChild(container),e.CURRENT_PAGE+1<=e.TOTAL_PAGES&&(markup=`${e.CURRENT_PAGE+1}`,container=document.createElement("li"),container.className="pagination__item",container.setAttribute("data-page",e.CURRENT_PAGE+1),container.innerHTML=markup,document.getElementById("pagination").appendChild(container)),e.CURRENT_PAGE+2<e.TOTAL_PAGES&&(markup=`${e.CURRENT_PAGE+2}`,container=document.createElement("li"),container.className="pagination__item",container.setAttribute("data-page",e.CURRENT_PAGE+2),container.innerHTML=markup,document.getElementById("pagination").appendChild(container)),e.CURRENT_PAGE+3<e.TOTAL_PAGES&&(markup="...",container=document.createElement("li"),container.className="pagination__item",container.innerHTML=markup,document.getElementById("pagination").appendChild(container)),e.CURRENT_PAGE+3<e.TOTAL_PAGES&&(markup=`${e.TOTAL_PAGES}`,container=document.createElement("li"),container.className="pagination__item",container.setAttribute("data-page",e.TOTAL_PAGES),container.innerHTML=markup,document.getElementById("pagination").appendChild(container)),e.CURRENT_PAGE<e.TOTAL_PAGES?document.querySelector('.button[data-page="next"]').classList="button button--next":document.querySelector('.button[data-page="next"]').classList="button button--next invisible"):document.querySelector(".pagination").classList="pagination hidden"},renderCards:()=>{let e=app.search;if(document.getElementById("search-results--cards").innerHTML="",e.DATA&&e.DATA.posts.length){const t=(e,t)=>`\n          <a href="${e.url}" class="" target="_self" title="${e.title}">\n            <span class="card__label text-orange">${e.category}</span>\n            <span class="card__label text-capitalize">${e.date}</span>\n            <h4 class="card__title">${e.title}</h4>\n            <p class="card__url">${e.url.replace(/^.*:\/\//i,"")}</p>\n          </a>`;let n="*"!==document.querySelector(".search__item--active").children[0].getAttribute("data-filter")&&document.querySelector(".search__item--active").children[0].getAttribute("data-filter");console.log("category = ",n),e.CURRENT_PAGE=1,e.TOTAL_PAGES=0,e.TOTAL_ITEMS=0,e.PAGES_TO_SKIPE=0,e.CURRENT_DATA=e.DATA.posts.filter(t=>{if(n){if(e.KEYWORD){if(t.category===n&&-1!=t.title.toLowerCase().indexOf(e.KEYWORD.toLowerCase()))return e.TOTAL_ITEMS++,e.TOTAL_PAGES=e.TOTAL_ITEMS-e.PAGE_SIZE>0?((e.TOTAL_ITEMS-e.PAGE_SIZE)/e.PAGE_SIZE).toFixed():0,t}else if(t.category===n)return e.TOTAL_ITEMS++,e.TOTAL_PAGES=e.TOTAL_ITEMS-e.PAGE_SIZE>0?((e.TOTAL_ITEMS-e.PAGE_SIZE)/e.PAGE_SIZE).toFixed():0,t}else{if(!e.KEYWORD)return e.TOTAL_ITEMS++,e.TOTAL_PAGES=e.TOTAL_ITEMS-e.PAGE_SIZE>0?((e.TOTAL_ITEMS-e.PAGE_SIZE)/e.PAGE_SIZE).toFixed():0,t;if(-1!=t.title.toLowerCase().indexOf(e.KEYWORD.toLowerCase()))return e.TOTAL_ITEMS++,e.TOTAL_PAGES=e.TOTAL_ITEMS-e.PAGE_SIZE>0?((e.TOTAL_ITEMS-e.PAGE_SIZE)/e.PAGE_SIZE).toFixed():0,t}}),e.CURRENT_DATA.slice(e.PAGES_TO_SKIPE,-(e.TOTAL_ITEMS-e.PAGE_SIZE-e.PAGES_TO_SKIPE)).map((e,n)=>{let a=t(e,n),i=document.createElement("div");i.className="col-12 card",i.innerHTML=a,document.getElementById("search-results--cards").append(i)}),console.log("current data = ",e.CURRENT_DATA)}}};
//# sourceMappingURL=maps/app.min.js.map
